<!DOCTYPE html>
<html lang="ar">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุฅูุดุงุก ุญุณุงุจ ุฌุฏูุฏ</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>

    <div class="container">
        <h2>ุฅูุดุงุก ุญุณุงุจ ุฌุฏูุฏ</h2>

        <form id="registerForm">

            <label>ุงูุงุณู ุงููุงูู</label>
            <input type="text" id="fullName" placeholder="ุงูุชุจ ุงุณูู" required>

            <label>ุฑูู ุงููุงุชู</label>
            <input type="text" id="phone" placeholder="010..." required>

            <label>ุงูุจุฑูุฏ ุงูุฅููุชุฑููู</label>
            <input type="email" id="email" placeholder="example@gmail.com" required>

            <label>ูููุฉ ุงููุฑูุฑ</label>
            <input type="password" id="password" placeholder="******" required>

            <button type="submit">ุฅูุดุงุก ุญุณุงุจ</button>

        </form>

        <p>
            ูุฏูู ุญุณุงุจ ุจุงููุนูุ  
            <a href="index.html">ุชุณุฌูู ุงูุฏุฎูู</a>
        </p>
    </div>

    <script>
        const API = "https://sheetdb.io/api/v1/u0utqc3ngifxy";

        document.getElementById("registerForm").addEventListener("submit", async function (e) {
            e.preventDefault();

            // ุจูุงูุงุช ุงููุณุชุฎุฏู
            let user = {
                FullName: document.getElementById("fullName").value,
                Phone: document.getElementById("phone").value,
                Email: document.getElementById("email").value,
                Password: document.getElementById("password").value
            };

            // ูก) ุงูุชุญูู ูู ูุฌูุฏ ุงูุฅูููู ูุจู ุงูุชุณุฌูู
            let check = await fetch(`${API}/search?Email=${user.Email}`);
            let exists = await check.json();

            if (exists.length > 0) {
                alert("ูุฐุง ุงูุจุฑูุฏ ูุณุชุฎุฏู ุจุงููุนู โ");
                return;
            }

            // ูข) ุฅุฑุณุงู ุงูุจูุงูุงุช
            let response = await fetch(API, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ data: user })
            });

            if (response.ok) {
                alert("ุชู ุฅูุดุงุก ุงูุญุณุงุจ ุจูุฌุงุญ ๐");
                window.location.href = "index.html";
            } else {
                alert("ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุงูุชุณุฌูู โ");
            }
        });
    </script>

</body>

</html>
